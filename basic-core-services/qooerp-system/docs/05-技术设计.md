# QooERP System 模块 - 技术设计文档

> **数据库**: PostgreSQL 15+

## 1. 技术选型

### 1.1 核心技术栈

| 技术组件 | 版本 | 用途 |
|---------|------|------|
| Spring Boot | 3.x | 应用框架 |
| MyBatis-Plus | 3.5.x | ORM框架 |
| PostgreSQL | 15+ | 关系型数据库 |
| Redis | 7.x | 缓存数据库 |
| Nacos | 2.x | 配置中心和服务发现 |
| EasyExcel | 3.x | Excel导入导出 |

### 1.2 前端技术栈

| 技术组件 | 版本 | 用途 |
|---------|------|------|
| Vue 3 | 3.x | 前端框架 |
| TDesign | Latest | UI 组件库 (PC+Mobile) |
| Electron | Latest | 桌面应用打包 |
| Capacitor | Latest | 移动应用打包 |
| TypeScript | 5.x | 类型系统 |
| Axios | Latest | HTTP 客户端 |
| Pinia | Latest | 状态管理 |
| Vite | 5.x | 构建工具 |

#### 前端架构说明

本项目采用**前后端分离架构**，所有微服务统一使用 `qooerp-frontend` 作为前端工程，通过 RESTful API 调用后端服务。

**前端工程结构**：
- 前端代码仓库：`qooerp-frontend`
- API 调用示例：前端 API 文件位于 `src/api/system.ts`
- 统一通过 API Gateway (qooerp-gateway) 访问后端服务

**多端支持**：
- PC 端：TDesign Vue Next
- 移动端：TDesign Mobile
- 桌面应用：Electron 打包
- 移动应用：Capacitor 打包（支持 iOS/Android）

**前端 API 封装示例**：
```typescript
// qooerp-frontend/packages/web/src/api/system.ts
import request from '@/utils/request'

export const systemApi = {
  dictList: (params: DictQuery) => {
    return request.get<PageResult<Dict>>('/api/system/dict/list', { params })
  },

  dictCreate: (data: DictCreate) => {
    return request.post<void>('/api/system/dict/create', data)
  }
}
```

### 1.3 依赖模块

```xml
<dependencies>
    <!-- 公共模块 -->
    <dependency>
        <groupId>com.qoobot</groupId>
        <artifactId>qooerp-common-api</artifactId>
    </dependency>
    <dependency>
        <groupId>com.qoobot</groupId>
        <artifactId>qooerp-common-core</artifactId>
    </dependency>

    <!-- 数据库 -->
    <dependency>
        <groupId>org.postgresql</groupId>
        <artifactId>postgresql</artifactId>
    </dependency>
    
    <!-- 缓存 -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-data-redis</artifactId>
    </dependency>
    
    <!-- Excel处理 -->
    <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>easyexcel</artifactId>
        <version>3.3.2</version>
    </dependency>
    
    <!-- 注册中心和配置中心 -->
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
    </dependency>
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
    </dependency>
</dependencies>
```

## 2. 架构设计

### 2.1 整体架构

```
┌─────────────────────────────────────────────────────────┐
│                   客户端层 (Web/Mobile)                   │
└──────────────────────┬──────────────────────────────────┘
                       │
┌──────────────────────▼──────────────────────────────────┐
│                    API Gateway                            │
│              (路由、认证、限流)                            │
└──────────────────────┬──────────────────────────────────┘
                       │
┌──────────────────────▼──────────────────────────────────┐
│               System Service                            │
│  ┌────────────────────────────────────────────────────┐  │
│  │              Controller 层                         │  │
│  │  - SystemDictController                            │  │
│  │  - SystemConfigController                          │  │
│  │  - SystemLogController                             │  │
│  │  - SystemAnnouncementController                    │  │
│  │  - SystemOnlineUserController                      │  │
│  │  - SystemImportExportController                    │  │
│  └──────────────────────┬─────────────────────────────┘  │
│  ┌──────────────────────▼─────────────────────────────┐  │
│  │              Service 层                             │  │
│  │  - SystemDictService                               │  │
│  │  - SystemConfigService                             │  │
│  │  - SystemLogService                                │  │
│  │  - SystemAnnouncementService                       │  │
│  │  - SystemOnlineUserService                         │  │
│  │  - SystemImportExportService                        │  │
│  └──────────────────────┬─────────────────────────────┘  │
│  ┌──────────────────────▼─────────────────────────────┐  │
│  │              Mapper 层                              │  │
│  │  - SystemDictMapper                                │  │
│  │  - SystemDictItemMapper                            │  │
│  │  - SystemConfigMapper                              │  │
│  │  - SystemLogMapper                                 │  │
│  │  - SystemAnnouncementMapper                         │  │
│  │  - SystemOnlineUserMapper                          │  │
│  │  - SystemImportExportMapper                        │  │
│  └──────────────────────┬─────────────────────────────┘  │
│  ┌──────────────────────▼─────────────────────────────┐  │
│  │              数据访问层                             │  │
│  │  - MyBatis-Plus                                     │  │
│  └────────────────────────────────────────────────────┘  │
└──────────────────────┬──────────────────────────────────┘
                       │
        ┌──────────────┼──────────────┬────────────┐
        │              │              │            │
┌───────▼──────┐ ┌────▼─────┐ ┌──────▼─────┐ ┌───▼────┐
│  PostgreSQL  │ │  Redis   │ │  文件服务  │ │ Nacos  │
│   (持久化)   │ │  (缓存)  │ │(Feign调用) │ │(配置)  │
└──────────────┘ └──────────┘ └────────────┘ └────────┘
```

### 2.2 微服务调用配置

#### Feign客户端配置

```java
@EnableFeignClients(basePackages = "com.qoobot.qooerp.system.feign")
@SpringBootApplication
public class QooerpSystemApplication {
    public static void main(String[] args) {
        SpringApplication.run(QooerpSystemApplication.class, args);
    }
}
```

#### 认证服务Feign客户端

```java
@FeignClient(name = "qooerp-auth", path = "/api/auth")
public interface AuthFeignClient {

    @GetMapping("/user/info")
    Result<LoginUser> getUserInfo(@RequestHeader("Authorization") String token);

    @PostMapping("/token/validate")
    Result<Boolean> validateToken(@RequestParam("token") String token);
}
```

#### 权限服务Feign客户端

```java
@FeignClient(name = "qooerp-permission", path = "/api/permission")
public interface PermissionFeignClient {

    @GetMapping("/check")
    Result<Boolean> checkPermission(
        @RequestParam("userId") Long userId,
        @RequestParam("resource") String resource,
        @RequestParam("action") String action
    );

    @GetMapping("/roles/{userId}")
    Result<List<String>> getUserRoles(@PathVariable("userId") Long userId);
}
```

#### Feign配置类

```java
@Configuration
public class FeignConfig {

    @Bean
    public RequestInterceptor requestInterceptor() {
        return template -> {
            // 传递认证token
            ServletRequestAttributes attributes =
                (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
            if (attributes != null) {
                String token = attributes.getRequest().getHeader("Authorization");
                if (token != null) {
                    template.header("Authorization", token);
                }
            }
        };
    }
}
```

#### application.yml配置

```yaml
# Feign配置
feign:
  client:
    config:
      default:
        connect-timeout: 5000
        read-timeout: 10000
  compression:
    request:
      enabled: true
      mime-types: application/json,application/xml
      min-request-size: 2048
    response:
      enabled: true

# 负载均衡
spring:
  cloud:
    loadbalancer:
      ribbon:
        enabled: false
```

## 3. 核心功能实现

### 3.1 字典缓存实现

#### 字典缓存服务

```java
@Service
public class SystemDictCacheService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    private static final String DICT_CACHE_KEY = "system:dict:";
    private static final String DICT_ITEM_CACHE_KEY = "system:dict:item:";
    private static final long CACHE_EXPIRE_SECONDS = 3600; // 1小时
    
    /**
     * 获取字典类型缓存
     */
    public SystemDictVO getDictByCode(String dictCode) {
        String key = DICT_CACHE_KEY + dictCode;
        SystemDictVO dict = (SystemDictVO) redisTemplate.opsForValue().get(key);
        
        if (dict == null) {
            dict = systemDictMapper.selectByCode(dictCode);
            if (dict != null) {
                redisTemplate.opsForValue().set(key, dict, CACHE_EXPIRE_SECONDS, TimeUnit.SECONDS);
            }
        }
        
        return dict;
    }
    
    /**
     * 获取字典项列表缓存
     */
    public List<SystemDictItemVO> getDictItemsByCode(String dictCode) {
        String key = DICT_ITEM_CACHE_KEY + dictCode;
        List<SystemDictItemVO> items = (List<SystemDictItemVO>) redisTemplate.opsForValue().get(key);
        
        if (items == null) {
            items = systemDictItemMapper.selectByDictCode(dictCode);
            if (items != null) {
                redisTemplate.opsForValue().set(key, items, CACHE_EXPIRE_SECONDS, TimeUnit.SECONDS);
            }
        }
        
        return items;
    }
    
    /**
     * 清除字典缓存
     */
    public void clearDictCache(String dictCode) {
        redisTemplate.delete(DICT_CACHE_KEY + dictCode);
        redisTemplate.delete(DICT_ITEM_CACHE_KEY + dictCode);
    }
}
```

### 3.2 日志异步处理

#### 异步日志服务

```java
@Service
public class SystemLogServiceImpl implements SystemLogService {
    
    @Autowired
    private SystemLogMapper systemLogMapper;
    
    @Autowired
    private SystemLogQueue logQueue;
    
    /**
     * 同步保存日志
     */
    @Override
    public void saveLog(SystemLogDTO logDTO) {
        SystemLog log = BeanUtil.copyProperties(logDTO, SystemLog.class);
        log.setUserId(SecurityUtils.getUserId());
        log.setUsername(SecurityUtils.getUsername());
        
        HttpServletRequest request = ServletUtils.getRequest();
        log.setIp(IpUtils.getIpAddr(request));
        log.setLocation(IpUtils.getLocation(log.getIp()));
        log.setUserAgent(request.getHeader("User-Agent"));
        
        systemLogMapper.insert(log);
    }
    
    /**
     * 异步保存日志
     */
    @Async
    @Override
    public void saveLogAsync(SystemLogDTO logDTO) {
        saveLog(logDTO);
    }
    
    /**
     * 批量异步保存日志
     */
    @Override
    public void batchSaveLog(List<SystemLogDTO> logList) {
        List<SystemLog> logs = logList.stream()
            .map(dto -> {
                SystemLog log = BeanUtil.copyProperties(dto, SystemLog.class);
                log.setUserId(SecurityUtils.getUserId());
                log.setUsername(SecurityUtils.getUsername());
                return log;
            })
            .collect(Collectors.toList());
        
        systemLogMapper.batchInsert(logs);
    }
}
```

#### 日志队列

```java
@Component
public class SystemLogQueue {
    
    private final Queue<SystemLogDTO> queue = new ConcurrentLinkedQueue<>();
    
    private final int BATCH_SIZE = 100;
    
    @Autowired
    private SystemLogService systemLogService;
    
    /**
     * 添加日志到队列
     */
    public void addLog(SystemLogDTO logDTO) {
        queue.offer(logDTO);
    }
    
    /**
     * 批量处理队列中的日志
     */
    @Scheduled(fixedDelay = 5000)
    public void processLogs() {
        List<SystemLogDTO> batch = new ArrayList<>();
        
        while (!queue.isEmpty() && batch.size() < BATCH_SIZE) {
            SystemLogDTO log = queue.poll();
            if (log != null) {
                batch.add(log);
            }
        }
        
        if (!batch.isEmpty()) {
            systemLogService.batchSaveLog(batch);
        }
    }
}
```

### 3.3 在线用户管理

#### 在线用户会话管理

```java
@Service
public class SystemOnlineUserServiceImpl implements SystemOnlineUserService {
    
    @Autowired
    private RedisTemplate<String, Object> redisTemplate;
    
    private static final String ONLINE_USER_KEY = "system:online:user:";
    private static final long SESSION_TIMEOUT = 1800; // 30分钟
    
    /**
     * 记录用户会话
     */
    @Override
    public void recordSession(Long userId, String username, String sessionId, 
                             String ip, String location) {
        String key = ONLINE_USER_KEY + userId;
        
        SystemOnlineUser onlineUser = new SystemOnlineUser();
        onlineUser.setUserId(userId);
        onlineUser.setUsername(username);
        onlineUser.setSessionId(sessionId);
        onlineUser.setIp(ip);
        onlineUser.setLocation(location);
        onlineUser.setLoginTime(new Date());
        onlineUser.setLastAccessTime(new Date());
        
        redisTemplate.opsForValue().set(key, onlineUser, SESSION_TIMEOUT, TimeUnit.SECONDS);
    }
    
    /**
     * 刷新会话时间
     */
    @Override
    public void refreshSession(Long userId) {
        String key = ONLINE_USER_KEY + userId;
        redisTemplate.expire(key, SESSION_TIMEOUT, TimeUnit.SECONDS);
        
        SystemOnlineUser user = (SystemOnlineUser) redisTemplate.opsForValue().get(key);
        if (user != null) {
            user.setLastAccessTime(new Date());
            redisTemplate.opsForValue().set(key, user, SESSION_TIMEOUT, TimeUnit.SECONDS);
        }
    }
    
    /**
     * 强制下线
     */
    @Override
    public void forceLogout(Long userId) {
        String key = ONLINE_USER_KEY + userId;
        redisTemplate.delete(key);
        
        // 通知认证模块销毁会话
        authApi.invalidateSession(userId);
    }
    
    /**
     * 查询在线用户列表
     */
    @Override
    public List<SystemOnlineUser> listOnlineUsers() {
        Set<String> keys = redisTemplate.keys(ONLINE_USER_KEY + "*");
        if (keys == null | keys.isEmpty()) {
            return new ArrayList<>();
        }
        
        return keys.stream()
            .map(key -> (SystemOnlineUser) redisTemplate.opsForValue().get(key))
            .filter(Objects::nonNull)
            .collect(Collectors.toList());
    }
}
```

### 3.4 数据导入导出

#### Excel导入服务

```java
@Service
public class DataImportServiceImpl implements DataImportService {
    
    @Autowired
    private FileService fileService;
    
    /**
     * 执行数据导入
     */
    @Override
    public ImportResultDTO importData(ImportTaskDTO importTask) {
        // 1. 下载导入文件
        InputStream inputStream = fileService.downloadFile(importTask.getFileId());
        
        // 2. 解析Excel
        List<Map<Integer, String>> dataList = EasyExcel.read(inputStream)
            .sheet()
            .doReadSync();
        
        // 3. 数据验证
        ValidationResult validationResult = validateData(importTask.getTemplateId(), dataList);
        if (!validationResult.isValid()) {
            return ImportResultDTO.failure(validationResult.getErrors());
        }
        
        // 4. 执行导入
        ImportResultDTO result = executeImport(importTask, validationResult.getValidData());
        
        // 5. 记录导入日志
        saveImportLog(importTask, result);
        
        return result;
    }
    
    /**
     * 数据验证
     */
    private ValidationResult validateData(Long templateId, 
                                          List<Map<Integer, String>> dataList) {
        ImportTemplate template = importTemplateMapper.selectById(templateId);
        
        ValidationResult result = new ValidationResult();
        List<ImportError> errors = new ArrayList<>();
        List<Map<Integer, String>> validData = new ArrayList<>();
        
        for (int i = 0; i < dataList.size(); i++) {
            Map<Integer, String> row = dataList.get(i);
            List<String> rowErrors = new ArrayList<>();
            
            // 验证每列数据
            for (ImportField field : template.getFields()) {
                String value = row.get(field.getColumnIndex());
                
                if (field.isRequired() && StringUtils.isEmpty(value)) {
                    rowErrors.add(field.getName() + "不能为空");
                } else if (!StringUtils.isEmpty(value)) {
                    if (!field.validate(value)) {
                        rowErrors.add(field.getName() + "格式不正确");
                    }
                }
            }
            
            if (rowErrors.isEmpty()) {
                validData.add(row);
            } else {
                errors.add(new ImportError(i + 1, String.join("; ", rowErrors)));
            }
        }
        
        result.setValidData(validData);
        result.setErrors(errors);
        result.setValid(errors.isEmpty());
        
        return result;
    }
}
```

#### Excel导出服务

```java
@Service
public class DataExportServiceImpl implements DataExportService {
    
    @Autowired
    private FileService fileService;
    
    /**
     * 执行数据导出
     */
    @Override
    public ExportResultDTO exportData(ExportTaskDTO exportTask) {
        // 1. 查询数据
        List<?> dataList = queryData(exportTask);
        
        // 2. 创建临时文件
        String tempFileName = UUID.randomUUID() + ".xlsx";
        File tempFile = new File(System.getProperty("java.io.tmpdir"), tempFileName);
        
        // 3. 写入Excel
        try (ExcelWriter excelWriter = EasyExcel.write(tempFile).build()) {
            WriteSheet writeSheet = EasyExcel.writerSheet("Sheet1")
                .head(exportTask.getTemplateId())
                .build();
            
            excelWriter.write(dataList, writeSheet);
        }
        
        // 4. 上传文件到文件服务
        FileUploadDTO uploadDTO = new FileUploadDTO();
        uploadDTO.setFile(new FileInputStream(tempFile));
        uploadDTO.setFileName(exportTask.getFileName());
        uploadDTO.setModule("export");
        
        String fileId = fileService.uploadFile(uploadDTO);
        
        // 5. 记录导出任务
        saveExportTask(exportTask, fileId, dataList.size());
        
        // 6. 删除临时文件
        tempFile.delete();
        
        return ExportResultDTO.success(fileId);
    }
}
```

## 4. 缓存设计

### 4.1 缓存策略

| 数据类型 | 缓存Key | 过期时间 | 更新策略 |
|---------|---------|----------|----------|
| 字典类型 | system:dict:{code} | 1小时 | 字典变更时清除 |
| 字典项 | system:dict:item:{code} | 1小时 | 字典项变更时清除 |
| 系统参数 | system:param:{key} | 30分钟 | 参数变更时清除 |
| 在线用户 | system:online:user:{userId} | 30分钟 | 会话访问时刷新 |
| 公告阅读 | system:announcement:read:{userId}:{announcementId} | 1天 | 公告撤回时清除 |

### 4.2 缓存预热

```java
@Component
public class CacheWarmUpService {
    
    @Autowired
    private SystemDictCacheService dictCacheService;
    
    @Autowired
    private SystemParamCacheService paramCacheService;
    
    /**
     * 缓存预热
     */
    @PostConstruct
    public void warmUp() {
        // 预热常用字典
        List<String> commonDictCodes = Arrays.asList(
            "common_status", "common_gender", "common_yes_no"
        );
        
        for (String dictCode : commonDictCodes) {
            dictCacheService.getDictByCode(dictCode);
            dictCacheService.getDictItemsByCode(dictCode);
        }
        
        // 预热系统参数
        List<String> commonParamKeys = Arrays.asList(
            "system.name", "system.version", "system.copyright"
        );
        
        for (String paramKey : commonParamKeys) {
            paramCacheService.getParamValue(paramKey);
        }
    }
}
```

## 5. 性能优化

### 5.1 数据库优化

#### 索引设计

```sql
-- system_dict表索引
CREATE INDEX idx_dict_code ON system_dict(code);
CREATE INDEX idx_dict_type ON system_dict(dict_type);

-- system_dict_item表索引
CREATE INDEX idx_dict_item_dict_id ON system_dict_item(dict_id);
CREATE INDEX idx_dict_item_value ON system_dict_item(item_value);

-- system_config表索引
CREATE INDEX idx_config_key ON system_config(param_key);
CREATE INDEX idx_config_group ON system_config(param_group);

-- system_log表索引
CREATE INDEX idx_log_user_id ON system_log(user_id);
CREATE INDEX idx_log_log_type ON system_log(log_type);
CREATE INDEX idx_log_created_time ON system_log(created_time);
CREATE INDEX idx_log_module ON system_log(module);

-- system_announcement表索引
CREATE INDEX idx_announcement_type ON system_announcement(type);
CREATE INDEX idx_announcement_status ON system_announcement(status);
CREATE INDEX idx_announcement_publish_time ON system_announcement(publish_time);

-- system_export_task表索引
CREATE INDEX idx_export_user_id ON system_export_task(user_id);
CREATE INDEX idx_export_status ON system_export_task(status);

-- system_import_task表索引
CREATE INDEX idx_import_user_id ON system_import_task(user_id);
CREATE INDEX idx_import_status ON system_import_task(status);
```

#### 分区表设计

```sql
-- 按月分区日志表
CREATE TABLE system_log (
    id BIGSERIAL,
    log_type VARCHAR(20),
    module VARCHAR(50),
    user_id BIGINT,
    created_time TIMESTAMP,
    -- 其他字段...
) PARTITION BY RANGE (created_time);

-- 创建分区
CREATE TABLE system_log_202501 PARTITION OF system_log
    FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');

CREATE TABLE system_log_202502 PARTITION OF system_log
    FOR VALUES FROM ('2025-02-01') TO ('2025-03-01');
```

## 6. 安全设计

### 6.1 敏感参数加密

```java
@Component
public class SensitiveParamEncryptor {
    
    @Value("${param.encrypt.key}")
    private String encryptKey;
    
    /**
     * 加密敏感参数
     */
    public String encrypt(String value) {
        try {
            return CryptoUtils.aesEncrypt(value, encryptKey);
        } catch (Exception e) {
            throw new BusinessException("参数加密失败: " + e.getMessage());
        }
    }
    
    /**
     * 解密敏感参数
     */
    public String decrypt(String encryptedValue) {
        try {
            return CryptoUtils.aesDecrypt(encryptedValue, encryptKey);
        } catch (Exception e) {
            throw new BusinessException("参数解密失败: " + e.getMessage());
        }
    }
}
```

### 6.2 审计日志

```java
@Aspect
@Component
public class AuditLogAspect {
    
    @Autowired
    private SystemAuditLogService auditLogService;
    
    /**
     * 审计日志切面
     */
    @Around("@annotation(auditLog)")
    public Object around(ProceedingJoinPoint point, AuditLog auditLog) throws Throwable {
        long startTime = System.currentTimeMillis();
        
        // 获取方法参数
        Object[] args = point.getArgs();
        String oldData = null;
        
        // 如果是更新操作，记录变更前数据
        if ("update".equals(auditLog.operation())) {
            oldData = getOldData(point.getSignature().getDeclaringType(), args);
        }
        
        // 执行方法
        Object result = point.proceed();
        
        long endTime = System.currentTimeMillis();
        
        // 记录审计日志
        SystemAuditLog auditLogEntity = new SystemAuditLog();
        auditLogEntity.setModule(auditLog.module());
        auditLogEntity.setOperation(auditLog.operation());
        auditLogEntity.setUserId(SecurityUtils.getUserId());
        auditLogEntity.setUsername(SecurityUtils.getUsername());
        auditLogEntity.setIp(IpUtils.getIpAddr());
        auditLogEntity.setOldData(oldData);
        auditLogEntity.setNewData(JSON.toJSONString(result));
        auditLogEntity.setCostTime(endTime - startTime);
        auditLogEntity.setCreateTime(new Date());
        
        auditLogService.save(auditLogEntity);
        
        return result;
    }
}
```

## 7. 部署配置

### 7.1 application.yml

```yaml
server:
  port: 8084

spring:
  application:
    name: qooerp-system
  
  datasource:
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://localhost:5432/qooerp
    username: postgres
    password: postgres
  
  redis:
    host: localhost
    port: 6379
    database: 3
    password:
  
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 50MB
  
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848
        namespace: qooerp
      config:
        server-addr: localhost:8848
        namespace: qooerp
        file-extension: yml

mybatis-plus:
  mapper-locations: classpath*:mapper/**/*.xml
  type-aliases-package: com.qoobot.qooerp.system.entity
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.slf4j.Slf4jImpl

# 异步配置
async:
  executor:
    core-pool-size: 5
    max-pool-size: 10
    queue-capacity: 100
    thread-name-prefix: system-async-

logging:
  level:
    com.qoobot.qooerp.system: debug
  file:
    name: /data/qooerp/logs/system.log
    max-size: 100MB
    max-history: 30
```

### 7.2 环境变量

| 变量名 | 说明 | 默认值 |
|--------|------|--------|
| SERVER_PORT | 服务端口 | 8084 |
| DB_URL | 数据库URL | - |
| DB_USERNAME | 数据库用户名 | - |
| DB_PASSWORD | 数据库密码 | - |
| REDIS_HOST | Redis主机 | localhost |
| REDIS_PORT | Redis端口 | 6379 |
| NACOS_ADDR | Nacos地址 | localhost:8848 |

## 8. 版本历史

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|----------|------|
| 1.0.0 | 2025-01-17 | 初始版本 | Auto |
| 1.1.0 | 20xx-xx-xx | 移除定时任务和文件管理功能，更新模块依赖 | Auto |
| 1.2.0 | 20xx-xx-xx | 更新模块依赖关系，明确与其他模块为并列微服务，通过Feign客户端调用；添加Feign配置说明 | Auto |
