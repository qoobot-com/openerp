
### 2.1 P0 级：核心基础服务（必选）

#### 2.1.1 qooerp-gateway（API 网关）

| 属性 | 说明 |
|------|------|
| **服务名称** | qooerp-gateway |
| **服务描述** | API 网关，统一流量入口 |
| **功能模块** | 路由转发、限流熔断、统一鉴权、请求日志 |
| **依赖服务** | qooerp-auth（鉴权）、qooerp-monitor（日志） |
| **端口** | 8080 |
| **部署模式** | 微服务模式专用（All-In-One 模式不需要） |
| **优先级** | P0-A（核心基础） |
| **状态** | ✅ 设计文档已完成 |
| **文档状态** | 01-业务设计.md ✅ / 02-应用设计.md ✅ / 03-数据设计.md ✅ / 04-API接口文档.md ✅ / 05-技术设计.md ✅ / 05-数据库脚本.sql ✅ |

**核心功能：**
- 路由转发（基于 Spring Cloud Gateway）
- 统一鉴权（JWT 令牌验证）
- 限流熔断（Sentinel 集成）
- 请求日志（访问日志、响应日志）
- 灰度发布（支持版本路由）

---

#### 2.1.2 qooerp-auth（认证服务）

| 属性 | 说明 |
|------|------|
| **服务名称** | qooerp-auth |
| **服务描述** | 身份认证与授权 |
| **功能模块** | 用户登录、SSO、JWT 令牌管理、MFA 验证 |
| **依赖服务** | qooerp-user（用户信息）、qooerp-permission（权限） |
| **端口** | 8081 |
| **数据库** | qooerp_auth |
| **部署模式** | All-In-One + 微服务 |
| **优先级** | P0-A（核心基础） |
| **状态** | ✅ 设计文档已完成 |
| **文档状态** | 01-业务设计.md ✅ / 02-应用设计.md ✅ / 03-数据设计.md ✅ / 04-API接口文档.md ✅ / 05-数据库脚本.sql ✅ |

**核心功能：**
- 用户登录（用户名/密码、手机号/验证码）
- SSO 单点登录（OAuth2.0/OIDC）
- JWT 令牌管理（生成、验证、刷新、吊销）
- MFA 多因素认证（短信验证码、TOTP）
- 第三方登录（微信、钉钉、企业微信）

**API 接口：**
```
POST /api/auth/login              # 用户登录
POST /api/auth/logout             # 用户登出
POST /api/auth/refresh            # 刷新令牌
POST /api/auth/sso                # SSO 登录
POST /api/auth/mfa/send           # 发送 MFA 验证码
POST /api/auth/mfa/verify         # 验证 MFA
POST /api/auth/thirdparty/weixin  # 微信登录
```

---

#### 2.1.3 qooerp-system（系统管理）

| 属性 | 说明 |
|------|------|
| **服务名称** | qooerp-system |
| **服务描述** | 系统配置与监控 |
| **功能模块** | 系统配置、日志管理、监控告警、健康检查 |
| **依赖服务** | 无 |
| **端口** | 8082 |
| **数据库** | qooerp_system |
| **部署模式** | All-In-One + 微服务 |
| **优先级** | P0-B（核心基础） |
| **状态** | ✅ 设计文档已完成 |
| **文档状态** | 01-业务设计.md ✅ / 02-应用设计.md ✅ / 03-数据设计.md ✅ / 04-API接口文档.md ✅ / 05-技术设计.md ✅ / 05-数据库脚本.sql ✅ |

**核心功能：**
- 系统配置（参数管理、配置导入导出）
- 日志管理（日志收集、查询、分析）
- 系统监控（性能监控、应用监控、业务监控）
- 健康检查（服务健康检测、故障检测）
- 版本管理（版本控制、升级回滚）

**API 接口：**
```
GET /api/system/config            # 获取系统配置
PUT /api/system/config            # 更新系统配置
GET /api/system/logs              # 查询日志
GET /api/system/monitor           # 获取监控指标
GET /api/system/health            # 健康检查
```

---

#### 2.1.4 qooerp-organization（组织管理）

| 属性 | 说明 |
|------|------|
| **服务名称** | qooerp-organization |
| **服务描述** | 组织架构管理 |
| **功能模块** | 组织管理、部门管理、岗位管理 |
| **依赖服务** | qooerp-user（用户关联） |
| **端口** | 8083 |
| **数据库** | qooerp_organization |
| **部署模式** | All-In-One + 微服务 |
| **优先级** | P0-C（核心基础） |
| **状态** | ✅ 设计文档已完成 |
| **文档状态** | 01-业务设计.md ✅ / 02-应用设计.md ✅ / 03-数据设计.md ✅ / 04-API接口文档.md ✅ / 05-技术设计.md ✅ / 05-数据库脚本.sql ✅ |

**核心功能：**
- 组织管理（公司、集团、子公司）
- 部门管理（部门树、部门层级）
- 岗位管理（岗位定义、岗位层级）
- 组织关系（组织树、部门岗位关系）

**API 接口：**
```
GET /api/org/organizations        # 获取组织列表
POST /api/org/organizations       # 创建组织
GET /api/org/departments          # 获取部门树
POST /api/org/departments         # 创建部门
GET /api/org/positions            # 获取岗位列表
POST /api/org/positions           # 创建岗位
```

---

#### 2.1.5 qooerp-user（用户管理）

| 属性 | 说明 |
|------|------|
| **服务名称** | qooerp-user |
| **服务描述** | 用户管理 |
| **功能模块** | 用户管理、用户角色、用户组织 |
| **依赖服务** | qooerp-organization（组织关联）、qooerp-permission（权限关联） |
| **端口** | 8084 |
| **数据库** | qooerp_user |
| **部署模式** | All-In-One + 微服务 |
| **优先级** | P0-C（核心基础） |
| **状态** | ✅ 设计文档已完成 |
| **文档状态** | 01-业务设计.md ✅ / 02-应用设计.md ✅ / 03-数据设计.md ✅ / 04-API接口文档.md ✅ / 05-技术设计.md ✅ / 05-数据库脚本.sql ✅ |

**核心功能：**
- 用户管理（用户 CRUD、用户查询）
- 用户角色（用户角色分配、用户角色查询）
- 用户组织（用户部门关联、用户岗位关联）
- 用户状态（启用/禁用、锁定/解锁）

**API 接口：**
```
GET /api/user/users               # 获取用户列表
POST /api/user/users              # 创建用户
GET /api/user/users/{id}          # 获取用户详情
PUT /api/user/users/{id}          # 更新用户
DELETE /api/user/users/{id}       # 删除用户
GET /api/user/users/{id}/roles    # 获取用户角色
POST /api/user/users/{id}/roles   # 分配角色
```

---

#### 2.1.6 qooerp-permission（权限管理）

| 属性 | 说明 |
|------|------|
| **服务名称** | qooerp-permission |
| **服务描述** | 权限管理 |
| **功能模块** | 角色管理、权限管理、数据权限、审计日志 |
| **依赖服务** | qooerp-system（审计日志） |
| **端口** | 8085 |
| **数据库** | qooerp_permission |
| **部署模式** | All-In-One + 微服务 |
| **优先级** | P0-A（核心基础） |
| **状态** | ✅ 设计文档已完成 |
| **文档状态** | 01-业务设计.md ✅ / 02-应用设计.md ✅ / 03-数据设计.md ✅ / 04-API接口文档.md ✅ / 05-技术设计.md ✅ / 05-数据库脚本.sql ✅ |

**核心功能：**
- 角色管理（角色 CRUD、角色权限）
- 权限管理（菜单权限、按钮权限）
- RBAC 权限（基于角色的访问控制）
- ABAC 权限（基于属性的访问控制）
- 数据权限（行级权限、列级权限、字段级权限）
- 审计日志（操作日志、审计追踪、合规报告）

**API 接口：**
```
GET /api/permission/roles         # 获取角色列表
POST /api/permission/roles        # 创建角色
GET /api/permission/permissions   # 获取权限列表
GET /api/permission/check         # 权限检查
GET /api/permission/data         # 数据权限查询
GET /api/permission/audit        # 审计日志
```

---