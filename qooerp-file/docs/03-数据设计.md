# QooERP 文件服务模块 - 数据设计文档

## 数据库表

### file_info（文件信息表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| file_no | VARCHAR | 文件编号 |
| file_name | VARCHAR | 文件名称 |
| file_path | VARCHAR | 文件路径 |
| file_size | BIGINT | 文件大小（字节） |
| file_type | VARCHAR | 文件类型（MIME） |
| file_extension | VARCHAR | 文件扩展名 |
| file_md5 | VARCHAR | 文件MD5 |
| storage_type | VARCHAR | 存储类型（minio/oss/local） |
| folder_id | BIGINT | 所属文件夹ID |
| status | TINYINT | 状态（1-正常 2-删除中 3-已删除） |
| download_count | INT | 下载次数 |
| tenant_id | BIGINT | 租户ID |
| creator_id | BIGINT | 创建人ID |
| create_time | DATETIME | 创建时间 |
| updater_id | BIGINT | 更新人ID |
| update_time | DATETIME | 更新时间 |
| deleted | TINYINT | 删除标记 |

### file_folder（文件夹表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| folder_no | VARCHAR | 文件夹编号 |
| folder_name | VARCHAR | 文件夹名称 |
| parent_id | BIGINT | 父文件夹ID |
| folder_path | VARCHAR | 文件夹路径 |
| folder_level | INT | 层级 |
| sort | INT | 排序 |
| status | TINYINT | 状态（1-正常 2-已删除） |
| tenant_id | BIGINT | 租户ID |
| creator_id | BIGINT | 创建人ID |
| create_time | DATETIME | 创建时间 |
| updater_id | BIGINT | 更新人ID |
| update_time | DATETIME | 更新时间 |
| deleted | TINYINT | 删除标记 |

### file_share（文件分享表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| file_id | BIGINT | 文件ID |
| share_code | VARCHAR | 分享码 |
| share_password | VARCHAR | 分享密码（加密） |
| share_name | VARCHAR | 分享标题 |
| share_desc | VARCHAR | 分享描述 |
| expire_time | DATETIME | 过期时间 |
| visit_count | INT | 访问次数 |
| download_count | INT | 下载次数 |
| status | TINYINT | 状态（1-有效 2-已取消） |
| tenant_id | BIGINT | 租户ID |
| creator_id | BIGINT | 创建人ID |
| create_time | DATETIME | 创建时间 |
| deleted | TINYINT | 删除标记 |

### file_log（文件操作日志表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| file_id | BIGINT | 文件ID |
| operation | VARCHAR | 操作类型（upload/download/delete/rename/move/share） |
| operation_desc | VARCHAR | 操作描述 |
| operator_id | BIGINT | 操作人ID |
| operator_name | VARCHAR | 操作人姓名 |
| operator_ip | VARCHAR | 操作IP |
| user_agent | VARCHAR | 用户代理 |
| operation_time | DATETIME | 操作时间 |
| tenant_id | BIGINT | 租户ID |

### file_quota（存储配额表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| tenant_id | BIGINT | 租户ID |
| total_quota | BIGINT | 总配额（字节） |
| used_quota | BIGINT | 已使用（字节） |
| file_count | INT | 文件数量 |
| folder_count | INT | 文件夹数量 |
| last_calculate_time | DATETIME | 最后计算时间 |

---

**文档版本**: v1.1
