# QooERP 财务管理 - 数据设计文档

> 版本：v1.0
> 创建日期：20xx-xx-xx
> 数据库：qooerp_finance

---

## 一、数据库表清单

| 序号 | 表名 | 说明 |
|------|------|------|
| 1 | finance_account | 科目表 |
| 2 | finance_voucher | 凭证表 |
| 3 | finance_voucher_detail | 凭证明细表 |
| 4 | finance_receivable | 应收账款表 |
| 5 | finance_receipt | 收款记录表 |
| 6 | finance_payable | 应付账款表 |
| 7 | finance_payment | 付款记录表 |
| 8 | finance_asset | 固定资产表 |
| 9 | finance_asset_depreciation | 资产折旧表 |
| 10 | finance_invoice | 发票表 |

---

## 二、核心表设计

### 2.1 finance_account（科目表）

```sql
CREATE TABLE finance_account (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    account_code VARCHAR(32) NOT NULL COMMENT '科目编码',
    account_name VARCHAR(128) NOT NULL COMMENT '科目名称',
    account_type VARCHAR(20) NOT NULL COMMENT '科目类型',
    level INT NOT NULL DEFAULT 1 COMMENT '科目级次',
    parent_id BIGINT DEFAULT NULL COMMENT '父科目ID',
    is_leaf TINYINT NOT NULL DEFAULT 0 COMMENT '是否末级',
    direction VARCHAR(10) NOT NULL COMMENT '借贷方向',
    balance_direction VARCHAR(10) NOT NULL COMMENT '余额方向',
    is_enabled TINYINT NOT NULL DEFAULT 1 COMMENT '是否启用',
    is_cash_account TINYINT NOT NULL DEFAULT 0 COMMENT '是否现金科目',
    is_bank_account TINYINT NOT NULL DEFAULT 0 COMMENT '是否银行科目',
    sort_order INT NOT NULL DEFAULT 0 COMMENT '排序号',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    PRIMARY KEY (id),
    UNIQUE KEY uk_account_code (tenant_id, account_code),
    KEY idx_parent_id (parent_id),
    KEY idx_account_type (account_type),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='科目表';
```

### 2.2 finance_voucher（凭证表）

```sql
CREATE TABLE finance_voucher (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    voucher_code VARCHAR(32) NOT NULL COMMENT '凭证编号',
    voucher_date DATE NOT NULL COMMENT '凭证日期',
    voucher_type VARCHAR(20) NOT NULL COMMENT '凭证类型',
    accounting_period VARCHAR(7) NOT NULL COMMENT '会计期间',
    debit_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '借方金额',
    credit_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '贷方金额',
    summary VARCHAR(512) DEFAULT NULL COMMENT '凭证摘要',
    creator_id BIGINT DEFAULT NULL COMMENT '制单人ID',
    reviewer_id BIGINT DEFAULT NULL COMMENT '审核人ID',
    review_status VARCHAR(20) NOT NULL DEFAULT 'DRAFT' COMMENT '审核状态',
    review_time DATETIME DEFAULT NULL COMMENT '审核时间',
    posting_status VARCHAR(20) NOT NULL DEFAULT 'UNPOSTED' COMMENT '记账状态',
    posting_time DATETIME DEFAULT NULL COMMENT '记账时间',
    attachment_count INT NOT NULL DEFAULT 0 COMMENT '附件数',
    remark VARCHAR(512) DEFAULT NULL COMMENT '备注',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    version INT NOT NULL DEFAULT 0 COMMENT '版本号',
    PRIMARY KEY (id),
    UNIQUE KEY uk_voucher_code (tenant_id, voucher_code),
    KEY idx_voucher_date (voucher_date),
    KEY idx_accounting_period (accounting_period),
    KEY idx_review_status (review_status),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='凭证表';
```

### 2.3 finance_voucher_detail（凭证明细表）

```sql
CREATE TABLE finance_voucher_detail (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    voucher_id BIGINT NOT NULL COMMENT '凭证ID',
    account_code VARCHAR(32) NOT NULL COMMENT '科目编码',
    account_name VARCHAR(128) NOT NULL COMMENT '科目名称',
    direction VARCHAR(10) NOT NULL COMMENT '借贷方向',
    amount DECIMAL(18,2) NOT NULL COMMENT '金额',
    summary VARCHAR(512) DEFAULT NULL COMMENT '摘要',
    auxiliary_type VARCHAR(20) DEFAULT NULL COMMENT '辅助核算类型',
    auxiliary_id BIGINT DEFAULT NULL COMMENT '辅助核算ID',
    sort_order INT NOT NULL DEFAULT 0 COMMENT '排序号',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    PRIMARY KEY (id),
    KEY idx_voucher_id (voucher_id),
    KEY idx_account_code (account_code),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='凭证明细表';
```

### 2.4 finance_receivable（应收账款表）

```sql
CREATE TABLE finance_receivable (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    receivable_code VARCHAR(32) NOT NULL COMMENT '应收单号',
    customer_id BIGINT NOT NULL COMMENT '客户ID',
    customer_name VARCHAR(128) NOT NULL COMMENT '客户名称',
    business_type VARCHAR(20) NOT NULL COMMENT '业务类型',
    related_order_id BIGINT DEFAULT NULL COMMENT '关联单据ID',
    related_order_code VARCHAR(64) DEFAULT NULL COMMENT '关联单据号',
    receivable_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '应收金额',
    received_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '已收金额',
    unpaid_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '未收金额',
    receivable_date DATE NOT NULL COMMENT '应收日期',
    due_date DATE NOT NULL COMMENT '到期日期',
    aging_days INT NOT NULL DEFAULT 0 COMMENT '账龄（天）',
    status VARCHAR(20) NOT NULL DEFAULT 'UNPAID' COMMENT '单据状态',
    remark VARCHAR(512) DEFAULT NULL COMMENT '备注',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    version INT NOT NULL DEFAULT 0 COMMENT '版本号',
    PRIMARY KEY (id),
    UNIQUE KEY uk_receivable_code (tenant_id, receivable_code),
    KEY idx_customer_id (customer_id),
    KEY idx_status (status),
    KEY idx_due_date (due_date),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='应收账款表';
```

### 2.5 finance_receipt（收款记录表）

```sql
CREATE TABLE finance_receipt (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    receipt_code VARCHAR(32) NOT NULL COMMENT '收款单号',
    receivable_id BIGINT NOT NULL COMMENT '应收单据ID',
    customer_id BIGINT NOT NULL COMMENT '客户ID',
    customer_name VARCHAR(128) NOT NULL COMMENT '客户名称',
    receipt_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '收款金额',
    receipt_date DATE NOT NULL COMMENT '收款日期',
    payment_method VARCHAR(20) NOT NULL COMMENT '收款方式',
    bank_account VARCHAR(64) DEFAULT NULL COMMENT '银行账户',
    remark VARCHAR(512) DEFAULT NULL COMMENT '备注',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    PRIMARY KEY (id),
    UNIQUE KEY uk_receipt_code (tenant_id, receipt_code),
    KEY idx_receivable_id (receivable_id),
    KEY idx_customer_id (customer_id),
    KEY idx_receipt_date (receipt_date),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='收款记录表';
```

### 2.6 finance_payable（应付账款表）

```sql
CREATE TABLE finance_payable (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    payable_code VARCHAR(32) NOT NULL COMMENT '应付单号',
    supplier_id BIGINT NOT NULL COMMENT '供应商ID',
    supplier_name VARCHAR(128) NOT NULL COMMENT '供应商名称',
    business_type VARCHAR(20) NOT NULL COMMENT '业务类型',
    related_order_id BIGINT DEFAULT NULL COMMENT '关联单据ID',
    related_order_code VARCHAR(64) DEFAULT NULL COMMENT '关联单据号',
    payable_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '应付金额',
    paid_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '已付金额',
    unpaid_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '未付金额',
    payable_date DATE NOT NULL COMMENT '应付日期',
    due_date DATE NOT NULL COMMENT '到期日期',
    aging_days INT NOT NULL DEFAULT 0 COMMENT '账龄（天）',
    status VARCHAR(20) NOT NULL DEFAULT 'UNPAID' COMMENT '单据状态',
    remark VARCHAR(512) DEFAULT NULL COMMENT '备注',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    version INT NOT NULL DEFAULT 0 COMMENT '版本号',
    PRIMARY KEY (id),
    UNIQUE KEY uk_payable_code (tenant_id, payable_code),
    KEY idx_supplier_id (supplier_id),
    KEY idx_status (status),
    KEY idx_due_date (due_date),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='应付账款表';
```

### 2.7 finance_payment（付款记录表）

```sql
CREATE TABLE finance_payment (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    payment_code VARCHAR(32) NOT NULL COMMENT '付款单号',
    payable_id BIGINT NOT NULL COMMENT '应付单据ID',
    supplier_id BIGINT NOT NULL COMMENT '供应商ID',
    supplier_name VARCHAR(128) NOT NULL COMMENT '供应商名称',
    payment_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '付款金额',
    payment_date DATE NOT NULL COMMENT '付款日期',
    payment_method VARCHAR(20) NOT NULL COMMENT '付款方式',
    bank_account VARCHAR(64) DEFAULT NULL COMMENT '银行账户',
    remark VARCHAR(512) DEFAULT NULL COMMENT '备注',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    PRIMARY KEY (id),
    UNIQUE KEY uk_payment_code (tenant_id, payment_code),
    KEY idx_payable_id (payable_id),
    KEY idx_supplier_id (supplier_id),
    KEY idx_payment_date (payment_date),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='付款记录表';
```

### 2.8 finance_asset（固定资产表）

```sql
CREATE TABLE finance_asset (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    asset_code VARCHAR(32) NOT NULL COMMENT '资产编码',
    asset_name VARCHAR(128) NOT NULL COMMENT '资产名称',
    category_id BIGINT NOT NULL COMMENT '资产分类ID',
    category_name VARCHAR(64) NOT NULL COMMENT '资产分类名称',
    specification VARCHAR(128) DEFAULT NULL COMMENT '规格型号',
    unit VARCHAR(20) DEFAULT NULL COMMENT '计量单位',
    quantity DECIMAL(10,2) NOT NULL DEFAULT 1.00 COMMENT '数量',
    original_value DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '原值',
    accumulated_depreciation DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '累计折旧',
    net_value DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '净值',
    department_id BIGINT DEFAULT NULL COMMENT '使用部门ID',
    department_name VARCHAR(64) DEFAULT NULL COMMENT '使用部门名称',
    user_id BIGINT DEFAULT NULL COMMENT '使用人ID',
    user_name VARCHAR(64) DEFAULT NULL COMMENT '使用人姓名',
    location VARCHAR(128) DEFAULT NULL COMMENT '存放地点',
    entry_date DATE NOT NULL COMMENT '入账日期',
    start_date DATE NOT NULL COMMENT '开始使用日期',
    useful_life INT NOT NULL DEFAULT 0 COMMENT '使用年限（年）',
    depreciation_method VARCHAR(20) NOT NULL DEFAULT 'STRAIGHT_LINE' COMMENT '折旧方法',
    depreciation_status VARCHAR(20) NOT NULL DEFAULT 'NORMAL' COMMENT '折旧状态',
    status VARCHAR(20) NOT NULL DEFAULT 'NORMAL' COMMENT '资产状态',
    remark VARCHAR(512) DEFAULT NULL COMMENT '备注',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    version INT NOT NULL DEFAULT 0 COMMENT '版本号',
    PRIMARY KEY (id),
    UNIQUE KEY uk_asset_code (tenant_id, asset_code),
    KEY idx_category_id (category_id),
    KEY idx_department_id (department_id),
    KEY idx_status (status),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='固定资产表';
```

### 2.9 finance_asset_depreciation（资产折旧表）

```sql
CREATE TABLE finance_asset_depreciation (
    id BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    tenant_id BIGINT NOT NULL DEFAULT 0 COMMENT '租户ID',
    asset_id BIGINT NOT NULL COMMENT '资产ID',
    depreciation_period VARCHAR(7) NOT NULL COMMENT '折旧期间',
    depreciation_amount DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '折旧金额',
    accumulated_depreciation DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '累计折旧',
    net_value DECIMAL(18,2) NOT NULL DEFAULT 0.00 COMMENT '净值',
    created_by BIGINT DEFAULT NULL COMMENT '创建人ID',
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_by BIGINT DEFAULT NULL COMMENT '更新人ID',
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    deleted TINYINT NOT NULL DEFAULT 0 COMMENT '删除标记',
    PRIMARY KEY (id),
    UNIQUE KEY uk_asset_period (tenant_id, asset_id, depreciation_period),
    KEY idx_asset_id (asset_id),
    KEY idx_depreciation_period (depreciation_period),
    KEY idx_deleted (deleted),
    KEY idx_tenant_id (tenant_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='资产折旧表';
```

---

## 三、枚举值说明

### 3.1 科目类型（account_type）

| 枚举值 | 说明 |
|--------|------|
| ASSET | 资产 |
| LIABILITY | 负债 |
| EQUITY | 所有者权益 |
| REVENUE | 收入 |
| EXPENSE | 费用 |

### 3.2 凭证类型（voucher_type）

| 枚举值 | 说明 |
|--------|------|
| RECEIPT | 收款凭证 |
| PAYMENT | 付款凭证 |
| TRANSFER | 转账凭证 |
| ADJUSTMENT | 调整凭证 |

### 3.3 折旧方法（depreciation_method）

| 枚举值 | 说明 |
|--------|------|
| STRAIGHT_LINE | 直线法 |
| DOUBLE_DECLINING | 双倍余额递减法 |
| SUM_OF_YEARS | 年数总和法 |

---

*文档维护：请保持此文档的及时更新，确保数据设计的准确性*
