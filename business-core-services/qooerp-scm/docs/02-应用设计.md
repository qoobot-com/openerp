# QooERP 供应链管理 - 应用设计文档

> 版本：v1.0
> 创建日期：2026-02-17
> 更新日期：2026-02-18

---

## 一、核心实体设计

### 1.1 ScmSupplier（供应商实体）

```java
package com.qoobot.qooerp.scm.supplier.domain;

import com.baomidou.mybatisplus.annotation.TableName;
import com.qoobot.qooerp.common.entity.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;
import java.math.BigDecimal;

/**
 * 供应商实体
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("scm_supplier")
public class ScmSupplier extends BaseEntity {
    
    /** 供应商编码 */
    private String supplierCode;
    
    /** 供应商名称 */
    private String supplierName;
    
    /** 供应商类型 */
    private String supplierType; // MANUFACTURER, DISTRIBUTOR, RETAILER
    
    /** 行业 */
    private String industry;
    
    /** 规模 */
    private String scale; // LARGE, MEDIUM, SMALL
    
    /** 联系人 */
    private String contactPerson;
    
    /** 联系电话 */
    private String contactPhone;
    
    /** 联系邮箱 */
    private String contactEmail;
    
    /** 地址 */
    private String address;
    
    /** 税号 */
    private String taxNumber;
    
    /** 开户银行 */
    private String bankName;
    
    /** 银行账号 */
    private String bankAccount;
    
    /** 信用等级 */
    private String creditLevel; // A, B, C, D
    
    /** 信用额度 */
    private BigDecimal creditLimit;
    
    /** 结算方式 */
    private String paymentMethod; // CASH, CREDIT, MONTHLY, QUARTERLY
    
    /** 付款期限（天） */
    private Integer paymentDays;
    
    /** 评估总分 */
    private Integer evaluationScore;
    
    /** 质量评分 */
    private Integer qualityScore;
    
    /** 交付评分 */
    private Integer deliveryScore;
    
    /** 服务评分 */
    private Integer serviceScore;
    
    /** 价格评分 */
    private Integer priceScore;
    
    /** 最后评估时间 */
    private java.time.LocalDateTime lastEvaluationTime;
    
    /** 状态 */
    private String status; // ACTIVE, INACTIVE, DISABLED
    
    /** 备注 */
    private String remark;
}
```

### 1.2 ScmSupplierEvaluation（供应商评估实体）

```java
package com.qoobot.qooerp.scm.supplier.domain;

import com.baomidou.mybatisplus.annotation.TableName;
import com.qoobot.qooerp.common.entity.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;

/**
 * 供应商评估实体
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("scm_supplier_evaluation")
public class ScmSupplierEvaluation extends BaseEntity {
    
    /** 供应商ID */
    private Long supplierId;
    
    /** 供应商编码 */
    private String supplierCode;
    
    /** 评估日期 */
    private java.time.LocalDate evaluationDate;
    
    /** 质量评分 */
    private Integer qualityScore;
    
    /** 交付评分 */
    private Integer deliveryScore;
    
    /** 服务评分 */
    private Integer serviceScore;
    
    /** 价格评分 */
    private Integer priceScore;
    
    /** 综合评分 */
    private Integer totalScore;
    
    /** 信用等级 */
    private String creditLevel;
    
    /** 评估人 */
    private String evaluator;
    
    /** 评估意见 */
    private String evaluationRemark;
}
```

### 1.3 ScmCustomer（客户实体）

```java
package com.qoobot.qooerp.scm.customer.domain;

import com.baomidou.mybatisplus.annotation.TableName;
import com.qoobot.qooerp.common.entity.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;
import java.math.BigDecimal;

/**
 * 客户实体
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("scm_customer")
public class ScmCustomer extends BaseEntity {
    
    /** 客户编码 */
    private String customerCode;
    
    /** 客户名称 */
    private String customerName;
    
    /** 客户类型 */
    private String customerType; // ENTERPRISE, INDIVIDUAL, GOVERNMENT
    
    /** 行业 */
    private String industry;
    
    /** 规模 */
    private String scale;
    
    /** 客户等级 */
    private String customerLevel; // VIP, IMPORTANT, NORMAL, POTENTIAL
    
    /** 联系人 */
    private String contactPerson;
    
    /** 联系电话 */
    private String contactPhone;
    
    /** 联系邮箱 */
    private String contactEmail;
    
    /** 地址 */
    private String address;
    
    /** 税号 */
    private String taxNumber;
    
    /** 开户银行 */
    private String bankName;
    
    /** 银行账号 */
    private String bankAccount;
    
    /** 信用额度 */
    private BigDecimal creditLimit;
    
    /** 结算方式 */
    private String paymentMethod;
    
    /** 付款期限（天） */
    private Integer paymentDays;
    
    /** 状态 */
    private String status;
    
    /** 备注 */
    private String remark;
}
```

### 1.4 ScmCustomerGrade（客户分级实体）

```java
package com.qoobot.qooerp.scm.customer.domain;

import com.baomidou.mybatisplus.annotation.TableName;
import com.qoobot.qooerp.common.entity.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;
import java.math.BigDecimal;

/**
 * 客户分级实体
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("scm_customer_grade")
public class ScmCustomerGrade extends BaseEntity {
    
    /** 客户ID */
    private Long customerId;
    
    /** 客户编码 */
    private String customerCode;
    
    /** 分级日期 */
    private java.time.LocalDate gradeDate;
    
    /** 年采购金额 */
    private BigDecimal annualPurchaseAmount;
    
    /** 采购频次 */
    private Integer purchaseCount;
    
    /** 平均客单价 */
    private BigDecimal averageOrderAmount;
    
    /** 退货率 */
    private BigDecimal returnRate;
    
    /** 客户等级 */
    private String customerLevel;
    
    /** 等级变更原因 */
    private String changeReason;
}
```

### 1.5 ScmLogistics（物流实体）

```java
package com.qoobot.qooerp.scm.logistics.domain;

import com.baomidou.mybatisplus.annotation.TableName;
import com.qoobot.qooerp.common.entity.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;
import java.math.BigDecimal;
import java.time.LocalDate;

/**
 * 物流实体
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("scm_logistics")
public class ScmLogistics extends BaseEntity {
    
    /** 物流单号 */
    private String logisticsCode;
    
    /** 业务类型 */
    private String businessType; // PURCHASE, SALES
    
    /** 关联单据ID */
    private Long relatedOrderId;
    
    /** 关联单据号 */
    private String relatedOrderCode;
    
    /** 物流公司 */
    private String logisticsCompany;
    
    /** 物流单号 */
    private String trackingNumber;
    
    /** 发货人 */
    private String sender;
    
    /** 发货人电话 */
    private String senderPhone;
    
    /** 发货地址 */
    private String senderAddress;
    
    /** 收货人 */
    private String receiver;
    
    /** 收货人电话 */
    private String receiverPhone;
    
    /** 收货地址 */
    private String receiverAddress;
    
    /** 发货日期 */
    private LocalDate shipmentDate;
    
    /** 预计到达日期 */
    private LocalDate estimatedArrivalDate;
    
    /** 实际到达日期 */
    private LocalDate actualArrivalDate;
    
    /** 物流费用 */
    private BigDecimal logisticsCost;
    
    /** 物流状态 */
    private String logisticsStatus; // PENDING, SHIPPED, IN_TRANSIT, DELIVERED, CANCELLED
    
    /** 备注 */
    private String remark;
}
```

### 1.6 ScmLogisticsTracking（物流跟踪实体）

```java
package com.qoobot.qooerp.scm.logistics.domain;

import com.baomidou.mybatisplus.annotation.TableName;
import com.qoobot.qooerp.common.entity.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;
import java.time.LocalDateTime;

/**
 * 物流跟踪实体
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("scm_logistics_tracking")
public class ScmLogisticsTracking extends BaseEntity {
    
    /** 物流ID */
    private Long logisticsId;
    
    /** 物流单号 */
    private String logisticsCode;
    
    /** 跟踪时间 */
    private LocalDateTime trackingTime;
    
    /** 位置 */
    private String location;
    
    /** 状态 */
    private String status;
    
    /** 描述 */
    private String description;
    
    /** 操作人 */
    private String operator;
}
```

---

## 二、核心DTO设计

### 2.1 SupplierDTO

```java
@Data
@Schema(description = "供应商DTO")
public class SupplierDTO {
    private Long id;
    private String supplierCode;
    private String supplierName;
    private String supplierType;
    private String industry;
    private String scale;
    private String contactPerson;
    private String contactPhone;
    private String contactEmail;
    private String address;
    private String taxNumber;
    private String bankName;
    private String bankAccount;
    private String creditLevel;
    private BigDecimal creditLimit;
    private String paymentMethod;
    private Integer paymentDays;
    private Integer evaluationScore;
    private Integer qualityScore;
    private Integer deliveryScore;
    private Integer serviceScore;
    private Integer priceScore;
    private String status;
    private String remark;
}
```

### 2.2 SupplierQueryDTO

```java
@Data
@Schema(description = "供应商查询DTO")
public class SupplierQueryDTO {
    private String supplierCode;
    private String supplierName;
    private String supplierType;
    private String creditLevel;
    private String status;
    private Integer current = 1;
    private Integer size = 10;
}
```

### 2.3 EvaluationDTO

```java
@Data
@Schema(description = "评估DTO")
public class EvaluationDTO {
    private Long supplierId;
    private Integer qualityScore;
    private Integer deliveryScore;
    private Integer serviceScore;
    private Integer priceScore;
    private String evaluationRemark;
}
```

### 2.4 CustomerDTO

```java
@Data
@Schema(description = "客户DTO")
public class CustomerDTO {
    private Long id;
    private String customerCode;
    private String customerName;
    private String customerType;
    private String industry;
    private String scale;
    private String customerLevel;
    private String contactPerson;
    private String contactPhone;
    private String contactEmail;
    private String address;
    private String taxNumber;
    private String bankName;
    private String bankAccount;
    private BigDecimal creditLimit;
    private String paymentMethod;
    private Integer paymentDays;
    private String status;
    private String remark;
}
```

### 2.5 CustomerQueryDTO

```java
@Data
@Schema(description = "客户查询DTO")
public class CustomerQueryDTO {
    private String customerCode;
    private String customerName;
    private String customerType;
    private String customerLevel;
    private String status;
    private Integer current = 1;
    private Integer size = 10;
}
```

### 2.6 LogisticsDTO

```java
@Data
@Schema(description = "物流DTO")
public class LogisticsDTO {
    private Long id;
    private String logisticsCode;
    private String businessType;
    private Long relatedOrderId;
    private String relatedOrderCode;
    private String logisticsCompany;
    private String trackingNumber;
    private String sender;
    private String senderPhone;
    private String senderAddress;
    private String receiver;
    private String receiverPhone;
    private String receiverAddress;
    private LocalDate shipmentDate;
    private LocalDate estimatedArrivalDate;
    private LocalDate actualArrivalDate;
    private BigDecimal logisticsCost;
    private String logisticsStatus;
    private String remark;
}
```

### 2.7 TrackingDTO

```java
@Data
@Schema(description = "物流跟踪DTO")
public class TrackingDTO {
    private Long id;
    private Long logisticsId;
    private String logisticsCode;
    private LocalDateTime trackingTime;
    private String location;
    private String status;
    private String description;
    private String operator;
}
```

---

## 三、核心服务接口

### 3.1 供应商服务

```java
public interface ScmSupplierService {
    Result<Long> createSupplier(SupplierDTO supplierDTO);
    Result<Void> updateSupplier(Long id, SupplierDTO supplierDTO);
    Result<Void> deleteSupplier(Long id);
    Result<SupplierDTO> getSupplier(Long id);
    Result<PageResult<SupplierDTO>> querySuppliers(SupplierQueryDTO queryDTO);
    Result<Void> evaluateSupplier(Long supplierId, EvaluationDTO evaluationDTO);
    Result<List<EvaluationDTO>> getEvaluationHistory(Long supplierId);
}
```

### 3.2 客户服务

```java
public interface ScmCustomerService {
    Result<Long> createCustomer(CustomerDTO customerDTO);
    Result<Void> updateCustomer(Long id, CustomerDTO customerDTO);
    Result<Void> deleteCustomer(Long id);
    Result<CustomerDTO> getCustomer(Long id);
    Result<PageResult<CustomerDTO>> queryCustomers(CustomerQueryDTO queryDTO);
    Result<Void> updateCustomerLevel(Long customerId, String level);
    Result<List<GradeDTO>> getGradeHistory(Long customerId);
}
```

### 3.3 物流服务

```java
public interface ScmLogisticsService {
    Result<Long> createLogistics(LogisticsDTO logisticsDTO);
    Result<Void> updateLogistics(Long id, LogisticsDTO logisticsDTO);
    Result<Void> trackLogistics(Long logisticsId, String status, String location, String description);
    Result<List<TrackingDTO>> queryTracking(Long logisticsId);
    Result<PageResult<LogisticsDTO>> queryLogistics(LogisticsQueryDTO queryDTO);
    Result<Void> updateStatus(Long id, String status);
}
```

---

## 四、包结构

```
com.qoobot.qooerp.scm
├── supplier          # 供应商管理
│   ├── domain
│   ├── dto
│   ├── mapper
│   ├── service
│   └── controller
├── customer          # 客户管理
│   ├── domain
│   ├── dto
│   ├── mapper
│   ├── service
│   └── controller
└── logistics         # 物流管理
    ├── domain
    ├── dto
    ├── mapper
    ├── service
    └── controller
```

---

## 五、错误码定义

| 错误码 | 错误信息 | 说明 |
|--------|---------|------|
| SCM_001 | 供应商编码已存在 | 指定的供应商编码已存在 |
| SCM_002 | 客户编码已存在 | 指定的客户编码已存在 |
| SCM_003 | 物流单号已存在 | 指定的物流单号已存在 |
| SCM_004 | 供应商不存在 | 指定的供应商不存在 |
| SCM_005 | 客户不存在 | 指定的客户不存在 |
| SCM_006 | 物流不存在 | 指定的物流不存在 |
| SCM_007 | 评估分数无效 | 评估分数必须在0-100之间 |
| SCM_008 | 客户等级无效 | 无效的客户等级 |

---

*文档维护：请保持此文档的及时更新*
