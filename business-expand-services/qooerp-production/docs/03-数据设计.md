# QooERP 生产管理模块 - 数据设计文档

> 模块名称: qooerp-production  
> 模块版本: v1.0  
> 创建日期: 20xx-xx-xx  
> 作者: Auto  

---

## 一、数据库设计

### 1.1 数据库信息

| 属性 | 说明 |
|------|------|
| 数据库名称 | qooerp_production |
| 字符集 | utf8mb4 |
| 排序规则 | utf8mb4_unicode_ci |
| 引擎 | InnoDB |

### 1.2 表清单

| 序号 | 表名 | 中文名称 | 说明 |
|------|------|---------|------|
| 1 | production_plan | 生产计划表 | 生产计划主表 |
| 2 | production_order | 生产订单表 | 生产订单主表 |
| 3 | production_material | 生产领料表 | 生产领料明细表 |
| 4 | production_receipt | 生产入库表 | 生产入库主表 |
| 5 | production_report | 生产报工表 | 生产报工记录表 |
| 6 | production_quality | 生产质检表 | 生产质检记录表 |
| 7 | production_plan_material | 计划物料表 | 计划物料明细表 |
| 8 | production_bom | 物料清单表 | 产品BOM表 |

---

## 二、表结构设计

### 2.1 production_plan（生产计划表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| plan_no | VARCHAR | 50 | NO | | 计划编号 |
| plan_name | VARCHAR | 200 | YES | | 计划名称 |
| plan_date | DATE | | NO | | 计划日期 |
| plan_quantity | DECIMAL | 18,4 | NO | | 计划数量 |
| status | TINYINT | 4 | NO | 0 | 状态(0-草稿,1-已审核,2-已下达,3-已完成,4-已取消) |
| product_id | BIGINT | 20 | NO | | 产品ID |
| product_code | VARCHAR | 50 | NO | | 产品编码 |
| product_name | VARCHAR | 200 | NO | | 产品名称 |
| delivery_date | DATE | | YES | | 交货日期 |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_plan_no` (`plan_no`, `tenant_id`, `deleted`)
- KEY `idx_product_id` (`product_id`)
- KEY `idx_plan_date` (`plan_date`)
- KEY `idx_status` (`status`)

---

### 2.2 production_order（生产订单表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| order_no | VARCHAR | 50 | NO | | 订单编号 |
| plan_id | BIGINT | 20 | YES | | 计划ID |
| plan_no | VARCHAR | 50 | YES | | 计划编号 |
| order_date | DATE | | NO | | 订单日期 |
| order_quantity | DECIMAL | 18,4 | NO | | 订单数量 |
| completed_quantity | DECIMAL | 18,4 | NO | 0 | 完成数量 |
| status | TINYINT | 4 | NO | 0 | 状态(0-草稿,1-已审核,2-已下达,3-生产中,4-已完成,5-已关闭) |
| product_id | BIGINT | 20 | NO | | 产品ID |
| product_code | VARCHAR | 50 | NO | | 产品编码 |
| product_name | VARCHAR | 200 | NO | | 产品名称 |
| start_date | DATE | | YES | | 开始日期 |
| end_date | DATE | | YES | | 完成日期 |
| delivery_date | DATE | | YES | | 交货日期 |
| workshop_id | BIGINT | 20 | YES | | 车间ID |
| workshop_name | VARCHAR | 100 | YES | | 车间名称 |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_order_no` (`order_no`, `tenant_id`, `deleted`)
- KEY `idx_plan_id` (`plan_id`)
- KEY `idx_product_id` (`product_id`)
- KEY `idx_order_date` (`order_date`)
- KEY `idx_status` (`status`)

---

### 2.3 production_material（生产领料表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| material_no | VARCHAR | 50 | NO | | 领料单号 |
| order_id | BIGINT | 20 | NO | | 订单ID |
| order_no | VARCHAR | 50 | NO | | 订单编号 |
| material_id | BIGINT | 20 | NO | | 物料ID |
| material_code | VARCHAR | 50 | NO | | 物料编码 |
| material_name | VARCHAR | 200 | NO | | 物料名称 |
| specification | VARCHAR | 200 | YES | | 规格型号 |
| unit | VARCHAR | 20 | YES | | 单位 |
| request_quantity | DECIMAL | 18,4 | NO | | 请领数量 |
| issued_quantity | DECIMAL | 18,4 | NO | 0 | 实发数量 |
| returned_quantity | DECIMAL | 18,4 | NO | 0 | 退回数量 |
| warehouse_id | BIGINT | 20 | YES | | 仓库ID |
| warehouse_name | VARCHAR | 100 | YES | | 仓库名称 |
| status | TINYINT | 4 | NO | 0 | 状态(0-草稿,1-已审核,2-已领料) |
| issue_date | DATE | | YES | | 领料日期 |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_material_no` (`material_no`, `tenant_id`, `deleted`)
- KEY `idx_order_id` (`order_id`)
- KEY `idx_material_id` (`material_id`)
- KEY `idx_issue_date` (`issue_date`)
- KEY `idx_status` (`status`)

---

### 2.4 production_receipt（生产入库表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| receipt_no | VARCHAR | 50 | NO | | 入库单号 |
| order_id | BIGINT | 20 | NO | | 订单ID |
| order_no | VARCHAR | 50 | NO | | 订单编号 |
| product_id | BIGINT | 20 | NO | | 产品ID |
| product_code | VARCHAR | 50 | NO | | 产品编码 |
| product_name | VARCHAR | 200 | NO | | 产品名称 |
| receipt_quantity | DECIMAL | 18,4 | NO | | 入库数量 |
| qualified_quantity | DECIMAL | 18,4 | NO | | 合格数量 |
| unqualified_quantity | DECIMAL | 18,4 | NO | 0 | 不合格数量 |
| warehouse_id | BIGINT | 20 | YES | | 仓库ID |
| warehouse_name | VARCHAR | 100 | YES | | 仓库名称 |
| quality_status | TINYINT | 4 | NO | 0 | 质检状态(0-待质检,1-合格,2-不合格) |
| status | TINYINT | 4 | NO | 0 | 状态(0-草稿,1-已审核,2-已入库) |
| receipt_date | DATE | | NO | | 入库日期 |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_receipt_no` (`receipt_no`, `tenant_id`, `deleted`)
- KEY `idx_order_id` (`order_id`)
- KEY `idx_product_id` (`product_id`)
- KEY `idx_receipt_date` (`receipt_date`)
- KEY `idx_status` (`status`)

---

### 2.5 production_report（生产报工表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| report_no | VARCHAR | 50 | NO | | 报工单号 |
| order_id | BIGINT | 20 | NO | | 订单ID |
| order_no | VARCHAR | 50 | NO | | 订单编号 |
| process_id | BIGINT | 20 | YES | | 工序ID |
| process_name | VARCHAR | 100 | YES | | 工序名称 |
| work_date | DATE | | NO | | 工作日期 |
| work_hours | DECIMAL | 10,2 | NO | | 工作时长(小时) |
| output_quantity | DECIMAL | 18,4 | NO | | 产出数量 |
| qualified_quantity | DECIMAL | 18,4 | NO | | 合格数量 |
| unqualified_quantity | DECIMAL | 18,4 | NO | 0 | 不合格数量 |
| worker_id | BIGINT | 20 | YES | | 工人ID |
| worker_name | VARCHAR | 50 | YES | | 工人姓名 |
| equipment_id | BIGINT | 20 | YES | | 设备ID |
| equipment_name | VARCHAR | 100 | YES | | 设备名称 |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_report_no` (`report_no`, `tenant_id`, `deleted`)
- KEY `idx_order_id` (`order_id`)
- KEY `idx_work_date` (`work_date`)
- KEY `idx_worker_id` (`worker_id`)

---

### 2.6 production_quality（生产质检表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| check_no | VARCHAR | 50 | NO | | 质检单号 |
| receipt_id | BIGINT | 20 | YES | | 入库单ID |
| order_id | BIGINT | 20 | NO | | 订单ID |
| order_no | VARCHAR | 50 | NO | | 订单编号 |
| product_id | BIGINT | 20 | NO | | 产品ID |
| product_code | VARCHAR | 50 | NO | | 产品编码 |
| product_name | VARCHAR | 200 | NO | | 产品名称 |
| check_date | DATE | | NO | | 质检日期 |
| check_quantity | DECIMAL | 18,4 | NO | | 质检数量 |
| qualified_quantity | DECIMAL | 18,4 | NO | | 合格数量 |
| unqualified_quantity | DECIMAL | 18,4 | NO | 0 | 不合格数量 |
| check_result | TINYINT | 4 | NO | | 质检结果(0-待检,1-合格,2-不合格) |
| defect_description | VARCHAR | 500 | YES | | 缺陷描述 |
| checker_id | BIGINT | 20 | YES | | 质检人ID |
| checker_name | VARCHAR | 50 | YES | | 质检人姓名 |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- UNIQUE KEY `uk_check_no` (`check_no`, `tenant_id`, `deleted`)
- KEY `idx_receipt_id` (`receipt_id`)
- KEY `idx_order_id` (`order_id`)
- KEY `idx_product_id` (`product_id`)
- KEY `idx_check_date` (`check_date`)

---

### 2.7 production_plan_material（计划物料表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| plan_id | BIGINT | 20 | NO | | 计划ID |
| material_id | BIGINT | 20 | NO | | 物料ID |
| material_code | VARCHAR | 50 | NO | | 物料编码 |
| material_name | VARCHAR | 200 | NO | | 物料名称 |
| specification | VARCHAR | 200 | YES | | 规格型号 |
| unit | VARCHAR | 20 | YES | | 单位 |
| required_quantity | DECIMAL | 18,4 | NO | | 需求数量 |
| current_stock | DECIMAL | 18,4 | NO | | 当前库存 |
| shortage_quantity | DECIMAL | 18,4 | NO | | 短缺数量 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- KEY `idx_plan_id` (`plan_id`)
- KEY `idx_material_id` (`material_id`)

---

### 2.8 production_bom（物料清单表）

| 字段名 | 类型 | 长度 | 允许空 | 默认值 | 说明 |
|--------|------|------|--------|--------|------|
| id | BIGINT | 20 | NO | | 主键 |
| parent_product_id | BIGINT | 20 | NO | | 父产品ID |
| parent_product_code | VARCHAR | 50 | NO | | 父产品编码 |
| parent_product_name | VARCHAR | 200 | NO | | 父产品名称 |
| material_id | BIGINT | 20 | NO | | 物料ID |
| material_code | VARCHAR | 50 | NO | | 物料编码 |
| material_name | VARCHAR | 200 | NO | | 物料名称 |
| specification | VARCHAR | 200 | YES | | 规格型号 |
| unit | VARCHAR | 20 | YES | | 单位 |
| quantity | DECIMAL | 18,4 | NO | | 用量 |
| material_type | TINYINT | 4 | NO | | 物料类型(1-原料,2-半成品,3-辅料) |
| is_optional | TINYINT | 1 | NO | 0 | 是否可选(0-否,1-是) |
| remark | VARCHAR | 500 | YES | | 备注 |
| tenant_id | BIGINT | 20 | NO | | 租户ID |
| create_time | DATETIME | | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | | NO | CURRENT_TIMESTAMP | 更新时间 |
| create_by | VARCHAR | 50 | YES | | 创建人 |
| update_by | VARCHAR | 50 | YES | | 更新人 |
| deleted | TINYINT | 1 | NO | 0 | 删除标记(0-未删除,1-已删除) |

**索引:**
- PRIMARY KEY (`id`)
- KEY `idx_parent_product_id` (`parent_product_id`)
- KEY `idx_material_id` (`material_id`)

---

## 三、ER图

```
production_plan (生产计划)
    │
    ├── production_order (生产订单) [1:N]
    │       │
    │       ├── production_material (生产领料) [1:N]
    │       ├── production_receipt (生产入库) [1:N]
    │       │       └── production_quality (生产质检) [1:1]
    │       └── production_report (生产报工) [1:N]
    │
    └── production_plan_material (计划物料) [1:N]

production_bom (物料清单)
    └── 产品-物料关系
```

---

## 四、数据字典

### 4.1 生产计划状态 (production_plan.status)

| 值 | 说明 |
|----|------|
| 0 | 草稿 |
| 1 | 已审核 |
| 2 | 已下达 |
| 3 | 已完成 |
| 4 | 已取消 |

### 4.2 生产订单状态 (production_order.status)

| 值 | 说明 |
|----|------|
| 0 | 草稿 |
| 1 | 已审核 |
| 2 | 已下达 |
| 3 | 生产中 |
| 4 | 已完成 |
| 5 | 已关闭 |

### 4.3 生产领料状态 (production_material.status)

| 值 | 说明 |
|----|------|
| 0 | 草稿 |
| 1 | 已审核 |
| 2 | 已领料 |

### 4.4 生产入库状态 (production_receipt.status)

| 值 | 说明 |
|----|------|
| 0 | 草稿 |
| 1 | 已审核 |
| 2 | 已入库 |

### 4.5 质检状态 (production_receipt.quality_status, production_quality.check_result)

| 值 | 说明 |
|----|------|
| 0 | 待质检 |
| 1 | 合格 |
| 2 | 不合格 |

---

**文档版本**: v1.0  
**最后更新**: 20xx-xx-xx
