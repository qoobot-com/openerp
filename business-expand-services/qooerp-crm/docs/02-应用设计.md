# QooERP 客户关系管理模块 - 应用设计文档

> 模块名称: qooerp-crm  
> 模块版本: v1.0  
> 创建日期: 20xx-xx-xx  
> 作者: Auto  

---

## 一、应用架构

### 1.1 分层架构

```
Presentation Layer (Controller)
Business Layer (Service, Domain)
Data Access Layer (Mapper, Entity)
Infrastructure Layer (Database, Cache)
```

### 1.2 核心模块

| 模块 | 说明 |
|------|------|
| customer | 客户管理 |
| opportunity | 商机管理 |
| contract | 合同管理 |
| service | 服务管理 |

---

## 二、核心类设计

### 2.1 Customer Service

```java
public interface CrmCustomerService {
    CrmCustomerDTO createCustomer(CrmCustomerDTO dto);
    CrmCustomerDTO updateCustomer(Long id, CrmCustomerDTO dto);
    void addFollowup(Long customerId, CrmFollowupDTO dto);
    Page<CrmCustomerDTO> listCustomers(PageParam pageParam);
}
```

### 2.2 Opportunity Service

```java
public interface CrmOpportunityService {
    CrmOpportunityDTO createOpportunity(CrmOpportunityDTO dto);
    void convertToContract(Long opportunityId);
    void updateStage(Long id, Integer stage);
    List<CrmOpportunityDTO> getCustomerOpportunities(Long customerId);
}
```

---

## 三、接口设计

### 3.1 Controller

```java
@RestController
@RequestMapping("/api/crm/customers")
public class CrmCustomerController {
    @PostMapping
    public Result<CrmCustomerDTO> createCustomer(@RequestBody CrmCustomerDTO dto);
    
    @GetMapping("/{id}")
    public Result<CrmCustomerDTO> getCustomer(@PathVariable Long id);
    
    @PostMapping("/{id}/followups")
    public Result<Void> addFollowup(@PathVariable Long id, 
        @RequestBody CrmFollowupDTO dto);
}
```

---

## 四、配置设计

```yaml
spring:
  application:
    name: qooerp-crm
  datasource:
    url: jdbc:postgresql://localhost:5432/qooerp_crm
```

---

**文档版本**: v1.0  
**最后更新**: 20xx-xx-xx
