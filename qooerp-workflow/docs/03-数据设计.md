# QooERP 工作流引擎模块 - 数据设计文档

> 模块名称: qooerp-workflow  
> 模块版本: v1.0  
> 创建日期: 2026-02-17  
> 作者: Auto  

---

## 一、数据库设计

| 表名 | 中文名称 | 说明 |
|------|---------|------|
| workflow_definition | 流程定义表 | 流程定义主表 |
| workflow_instance | 流程实例表 | 流程实例主表 |
| workflow_task | 流程任务表 | 流程任务主表 |
| workflow_variable | 流程变量表 | 流程变量表 |
| workflow_log | 流程日志表 | 流程日志表 |

---

## 二、表结构

### 2.1 workflow_definition（流程定义表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| definition_id | VARCHAR | 流程定义ID |
| definition_name | VARCHAR | 流程定义名称 |
| definition_key | VARCHAR | 流程定义Key |
| version | INT | 版本号 |
| bpmn_content | TEXT | BPMN内容 |
| status | TINYINT | 状态(0-草稿,1-已发布,2-已停用) |
| category | VARCHAR | 流程分类 |
| description | TEXT | 流程描述 |
| deploy_time | DATETIME | 部署时间 |
| tenant_id | BIGINT | 租户ID |

### 2.2 workflow_instance（流程实例表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| instance_id | VARCHAR | 流程实例ID |
| definition_id | VARCHAR | 流程定义ID |
| instance_name | VARCHAR | 流程实例名称 |
| business_key | VARCHAR | 业务Key |
| status | TINYINT | 状态(0-运行中,1-已完成,2-已取消,3-已挂起) |
| start_time | DATETIME | 开始时间 |
| end_time | DATETIME | 结束时间 |
| start_user_id | BIGINT | 发起人ID |
| start_user_name | VARCHAR | 发起人姓名 |
| tenant_id | BIGINT | 租户ID |

### 2.3 workflow_task（流程任务表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| task_id | VARCHAR | 任务ID |
| instance_id | VARCHAR | 流程实例ID |
| task_name | VARCHAR | 任务名称 |
| task_key | VARCHAR | 任务Key |
| assignee_id | BIGINT | 处理人ID |
| assignee_name | VARCHAR | 处理人姓名 |
| status | TINYINT | 状态(0-待处理,1-已处理,2-已驳回) |
| create_time | DATETIME | 创建时间 |
| due_time | DATETIME | 到期时间 |
| complete_time | DATETIME | 完成时间 |
| tenant_id | BIGINT | 租户ID |

### 2.4 workflow_variable（流程变量表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| instance_id | VARCHAR | 流程实例ID |
| task_id | VARCHAR | 任务ID(可选) |
| variable_name | VARCHAR | 变量名称 |
| variable_value | TEXT | 变量值 |
| variable_type | VARCHAR | 变量类型 |
| tenant_id | BIGINT | 租户ID |

### 2.5 workflow_log（流程日志表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| instance_id | VARCHAR | 流程实例ID |
| task_id | VARCHAR | 任务ID |
| action | VARCHAR | 操作类型 |
| action_user_id | BIGINT | 操作人ID |
| action_user_name | VARCHAR | 操作人姓名 |
| action_comment | TEXT | 操作意见 |
| action_time | DATETIME | 操作时间 |
| tenant_id | BIGINT | 租户ID |

---

## 三、数据字典

### 3.1 流程定义状态

| 值 | 说明 |
|----|------|
| 0 | 草稿 |
| 1 | 已发布 |
| 2 | 已停用 |

### 3.2 流程实例状态

| 值 | 说明 |
|----|------|
| 0 | 运行中 |
| 1 | 已完成 |
| 2 | 已取消 |
| 3 | 已挂起 |

### 3.3 任务状态

| 值 | 说明 |
|----|------|
| 0 | 待处理 |
| 1 | 已处理 |
| 2 | 已驳回 |

---

**文档版本**: v1.0  
**最后更新**: 2026-02-17
