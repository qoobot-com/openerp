# QooERP 库存管理 - 业务设计文档

> 版本：v1.1
> 创建日期：2026-02-17
> 服务名称：qooerp-inventory
> 优先级：P1-B（核心业务）
> 端口：8090

---

## 一、概述

库存管理是 QooERP 的核心业务模块之一，负责物料管理、库存查询、库存调拨、库存盘点、入库出库等库存核心业务。

---

## 二、核心实体

```
InventoryMaterial（物料）
InventoryStock（库存）
InventoryTransfer（调拨单）
InventoryTransferDetail（调拨明细）
InventoryCheck（盘点单）
InventoryCheckDetail（盘点明细）
InventoryStockInbound（入库单）
InventoryStockInboundDetail（入库明细）
InventoryStockOutbound（出库单）
InventoryStockOutboundDetail（出库明细）
InventoryStockRecord（库存变动记录）
InventoryWarehouse（仓库）
InventoryMaterialCategory（物料分类）
```

---

## 三、功能模块

| 模块 | 功能 |
|------|------|
| 物料管理 | 物料档案、物料分类、物料查询 |
| 仓库管理 | 仓库档案、仓库区域、仓库查询 |
| 库存查询 | 库存数量、库存明细、库存预警 |
| 入库管理 | 入库单创建、入库单审核、入库执行 |
| 出库管理 | 出库单创建、出库单审核、出库执行 |
| 库存调拨 | 调拨单创建、调拨单审核、调拨执行 |
| 库存盘点 | 盘点单创建、盘点单审核、盘点执行 |
| 库存调整 | 盘点调整、损耗调整、其他调整 |
| 库存预警 | 库存不足预警、库存积压预警、效期预警 |
| 库存报表 | 库存汇总、出入库统计、库龄分析 |

---

## 四、业务流程

### 4.1 入库流程
1. 创建入库单（采购入库、退货入库、调拨入库等）
2. 审核入库单
3. 执行入库（更新库存、生成入库记录）
4. 打印入库单据

### 4.2 出库流程
1. 创建出库单（销售出库、领料出库、调拨出库等）
2. 审核出库单
3. 检查库存是否充足
4. 执行出库（扣减库存、生成出库记录）
5. 打印出库单据

### 4.3 调拨流程
1. 创建调拨单（仓库间调拨）
2. 审核调拨单
3. 执行调拨（减少调出仓库库存、增加调入仓库库存）
4. 打印调拨单据

### 4.4 盘点流程
1. 创建盘点单（选择仓库、盘点范围）
2. 实际盘点（录入实际数量）
3. 生成盘点差异
4. 审核盘点单
5. 调整库存（根据盘点结果更新库存）

---

## 五、核心表清单

| 表名 | 说明 |
|------|------|
| inventory_warehouse | 仓库表 |
| inventory_material_category | 物料分类表 |
| inventory_material | 物料表 |
| inventory_stock | 库存表 |
| inventory_stock_inbound | 入库单表 |
| inventory_stock_inbound_detail | 入库明细表 |
| inventory_stock_outbound | 出库单表 |
| inventory_stock_outbound_detail | 出库明细表 |
| inventory_transfer | 调拨单表 |
| inventory_transfer_detail | 调拨明细表 |
| inventory_check | 盘点单表 |
| inventory_check_detail | 盘点明细表 |
| inventory_stock_record | 库存变动记录表 |

---

## 六、库存管理规则

### 6.1 库存计算
- 当前库存 = 可用库存 + 锁定库存
- 可用库存 = 当前库存 - 锁定库存
- 在途库存 = 已采购未入库数量

### 6.2 库存预警
- 库存不足：当前库存 < 最小库存
- 库存积压：当前库存 > 最大库存
- 安全库存：库存低于安全库存时触发预警

### 6.3 成本核算
- 标准成本法：按预设标准成本核算
- 实际成本法：按实际采购成本核算
- 移动平均法：按加权平均成本核算

---

**文档版本**: v1.1
