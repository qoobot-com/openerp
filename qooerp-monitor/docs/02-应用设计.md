# QooERP 监控服务模块 - 应用设计文档

## 核心接口

### MonitorController（监控服务控制器）

```java
@RestController
@RequestMapping("/api/monitor/service")
public class MonitorController {
    // 服务管理
    @GetMapping("/list")
    public Result<List<MonitorServiceDTO>> listServices();

    @PostMapping("/register")
    public Result<Long> registerService(@RequestBody MonitorServiceCreateDTO dto);

    @PutMapping("/{id}")
    public Result<Void> updateService(@PathVariable Long id, @RequestBody MonitorServiceUpdateDTO dto);

    @DeleteMapping("/{id}")
    public Result<Void> deleteService(@PathVariable Long id);

    @GetMapping("/{id}")
    public Result<MonitorServiceDTO> getService(@PathVariable Long id);

    @PostMapping("/check")
    public Result<Void> healthCheck(@RequestBody ServiceCheckDTO dto);
}
```

### MonitorAlertController（告警管理控制器）

```java
@RestController
@RequestMapping("/api/monitor/alert")
public class MonitorAlertController {
    // 告警管理
    @GetMapping("/list")
    public Result<Page<MonitorAlertDTO>> listAlerts(@RequestBody AlertQueryDTO dto);

    @GetMapping("/{id}")
    public Result<MonitorAlertDTO> getAlert(@PathVariable Long id);

    @PostMapping("/handle/{id}")
    public Result<Void> handleAlert(@PathVariable Long id, @RequestBody AlertHandleDTO dto);

    @GetMapping("/statistics")
    public Result<AlertStatisticsDTO> getStatistics(@RequestBody AlertStatisticsQueryDTO dto);
}
```

### MonitorAlertRuleController（告警规则控制器）

```java
@RestController
@RequestMapping("/api/monitor/alert-rule")
public class MonitorAlertRuleController {
    @PostMapping("/create")
    public Result<Long> createRule(@RequestBody AlertRuleCreateDTO dto);

    @PutMapping("/{id}")
    public Result<Void> updateRule(@PathVariable Long id, @RequestBody AlertRuleUpdateDTO dto);

    @DeleteMapping("/{id}")
    public Result<Void> deleteRule(@PathVariable Long id);

    @GetMapping("/list")
    public Result<Page<AlertRuleDTO>> listRules(@RequestBody AlertRuleQueryDTO dto);

    @GetMapping("/{id}")
    public Result<AlertRuleDTO> getRule(@PathVariable Long id);

    @PutMapping("/{id}/enable")
    public Result<Void> enableRule(@PathVariable Long id);

    @PutMapping("/{id}/disable")
    public Result<Void> disableRule(@PathVariable Long id);
}
```

### MonitorAlertChannelController（告警通知渠道控制器）

```java
@RestController
@RequestMapping("/api/monitor/alert-channel")
public class MonitorAlertChannelController {
    @PostMapping("/create")
    public Result<Long> createChannel(@RequestBody AlertChannelCreateDTO dto);

    @PutMapping("/{id}")
    public Result<Void> updateChannel(@PathVariable Long id, @RequestBody AlertChannelUpdateDTO dto);

    @DeleteMapping("/{id}")
    public Result<Void> deleteChannel(@PathVariable Long id);

    @GetMapping("/list")
    public Result<List<AlertChannelDTO>> listChannels();

    @GetMapping("/{id}")
    public Result<AlertChannelDTO> getChannel(@PathVariable Long id);
}
```

### MonitorLogController（监控日志控制器）

```java
@RestController
@RequestMapping("/api/monitor/log")
public class MonitorLogController {
    @PostMapping("/list")
    public Result<Page<MonitorLogDTO>> listLogs(@RequestBody LogQueryDTO dto);

    @GetMapping("/types")
    public Result<List<String>> listLogTypes();
}
```

### MonitorMetricsController（性能指标控制器）

```java
@RestController
@RequestMapping("/api/monitor/metrics")
public class MonitorMetricsController {
    @GetMapping("/current")
    public Result<MonitorMetricsDTO> getCurrentMetrics(@RequestParam String serviceName);

    @PostMapping("/history")
    public Result<Page<MonitorMetricsDTO>> getHistoryMetrics(@RequestBody MetricsQueryDTO dto);

    @GetMapping("/summary")
    public Result<MetricsSummaryDTO> getSummary(@RequestBody MetricsSummaryQueryDTO dto);

    @GetMapping("/trend")
    public Result<List<MetricsTrendDTO>> getTrend(@RequestBody MetricsTrendQueryDTO dto);
}
```

### MonitorTraceController（链路追踪控制器）

```java
@RestController
@RequestMapping("/api/monitor/trace")
public class MonitorTraceController {
    @GetMapping("/{traceId}")
    public Result<List<MonitorTraceDTO>> getTrace(@PathVariable String traceId);

    @PostMapping("/list")
    public Result<Page<MonitorTraceDTO>> listTraces(@RequestBody TraceQueryDTO dto);

    @GetMapping("/spans/{traceId}")
    public Result<List<MonitorTraceDTO>> getSpans(@PathVariable String traceId);
}
```

### MonitorDashboardController（监控仪表盘控制器）

```java
@RestController
@RequestMapping("/api/monitor/dashboard")
public class MonitorDashboardController {
    @GetMapping("/overview")
    public Result<DashboardOverviewDTO> getOverview();

    @GetMapping("/services-status")
    public Result<List<ServiceStatusDTO>> getServicesStatus();

    @GetMapping("/realtime-alerts")
    public Result<List<MonitorAlertDTO>> getRealtimeAlerts();

    @GetMapping("/metrics-trend")
    public Result<List<MetricsTrendDTO>> getMetricsTrend(@RequestBody MetricsTrendQueryDTO dto);
}
```

---

**文档版本**: v1.0
