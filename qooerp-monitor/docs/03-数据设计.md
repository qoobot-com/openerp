# QooERP 监控服务模块 - 数据设计文档

## 数据库表

### monitor_service（监控服务表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| service_name | VARCHAR | 服务名称 |
| service_address | VARCHAR | 服务地址 |
| service_port | INT | 服务端口 |
| status | TINYINT | 状态(0:离线 1:在线) |
| health_status | TINYINT | 健康状态(0:异常 1:正常) |
| last_check_time | DATETIME | 最后检查时间 |

### monitor_alert（告警信息表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| service_name | VARCHAR | 服务名称 |
| alert_type | VARCHAR | 告警类型 |
| alert_level | TINYINT | 告警级别(0:信息 1:警告 2:严重 3:紧急) |
| alert_content | TEXT | 告警内容 |
| alert_time | DATETIME | 告警时间 |
| status | TINYINT | 状态(0:待处理 1:已处理 2:已关闭) |
| handler_id | BIGINT | 处理人ID |
| handle_time | DATETIME | 处理时间 |
| handle_remark | TEXT | 处理备注 |

### monitor_alert_rule（告警规则表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| rule_name | VARCHAR | 规则名称 |
| rule_type | VARCHAR | 规则类型(service/metric/business) |
| metric_name | VARCHAR | 指标名称 |
| condition_operator | VARCHAR | 条件操作符(gt/lt/ge/le/eq) |
| threshold_value | DECIMAL | 阈值 |
| alert_level | TINYINT | 告警级别(0:信息 1:警告 2:严重 3:紧急) |
| enabled | TINYINT | 是否启用(0:禁用 1:启用) |
| notification_channels | VARCHAR | 通知渠道(逗号分隔) |
| description | TEXT | 规则描述 |

### monitor_alert_channel（告警通知渠道表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| channel_name | VARCHAR | 渠道名称 |
| channel_type | VARCHAR | 渠道类型(sms/email/site/webhook) |
| channel_config | TEXT | 渠道配置(JSON格式) |
| enabled | TINYINT | 是否启用(0:禁用 1:启用) |
| description | TEXT | 渠道描述 |

### monitor_alert_handle（告警处理记录表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| alert_id | BIGINT | 告警ID |
| handler_id | BIGINT | 处理人ID |
| handle_action | VARCHAR | 处理动作(确认/关闭/忽略) |
| handle_remark | TEXT | 处理备注 |
| handle_time | DATETIME | 处理时间 |

### monitor_log（监控日志表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| service_name | VARCHAR | 服务名称 |
| log_type | VARCHAR | 日志类型(monitor/access/error) |
| log_level | VARCHAR | 日志级别(DEBUG/INFO/WARN/ERROR) |
| log_content | TEXT | 日志内容 |
| log_time | DATETIME | 日志时间 |
| ip_address | VARCHAR | IP地址 |
| user_id | BIGINT | 用户ID |

### monitor_metrics（性能指标表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| service_name | VARCHAR | 服务名称 |
| metric_type | VARCHAR | 指标类型(cpu/memory/disk/network/jvm) |
| metric_name | VARCHAR | 指标名称 |
| metric_value | DECIMAL | 指标值 |
| metric_unit | VARCHAR | 指标单位 |
| collect_time | DATETIME | 采集时间 |

### monitor_trace（链路追踪表）

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| trace_id | VARCHAR | 追踪ID |
| span_id | VARCHAR | 跨度ID |
| parent_span_id | VARCHAR | 父跨度ID |
| service_name | VARCHAR | 服务名称 |
| operation_name | VARCHAR | 操作名称 |
| start_time | DATETIME | 开始时间 |
| duration | BIGINT | 持续时间(毫秒) |
| status_code | INT | 状态码 |
| tags | TEXT | 标签(JSON格式) |
| logs | TEXT | 日志(JSON格式) |

---

**文档版本**: v1.0
